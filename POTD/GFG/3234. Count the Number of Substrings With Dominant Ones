class Solution {
public:
     int numberOfSubstrings(string s) 
    {
      vector<int>pos;
      int ans = 0;
      int n = s.size();

      for( int i = 0 ; i < n ; i++ )
      if( s[i] == '0' )
      pos.push_back(i);
      
      int sq = 1;
      int m = pos.size();
      
      for( ; sq * sq <= n ; sq++ )
      {
        int k = sq*sq;  
        for( int i = 0 ; i + sq <= m ; i++ )
        {
            int j = i + sq - 1;
            int d = pos[j] - pos[i] + 1;
            int one = d - sq;
            if( one >= k )
            continue;
            int need = k-one-1;
            int l = i ? pos[i] - pos[i-1] - 1 : pos[i] ;
            int r = j < m - 1 ? pos[j+1] - pos[j] - 1 : n - pos[j] - 1;
            l = min(l,need);
            r = min(r,need);
            if( l < r )
            swap(l,r);

            ans += 1 + l + r;
            ans += l*r;

            int x = min(l,need - r);
            l -= x;
            ans -= (l*(l+1))/2;

        }
      }

      for( int i = 0 ; i + sq <= m ; i++ )
      {
        int r =  n - pos[i + sq - 1] - 1 ;
        int l = i ? pos[i] - pos[i-1] - 1 : pos[i] ;
        int tot = 1 + l + r + l*r;
        ans += tot;
      }

      int res = (n*(n+1))/2 - ans;
      return res;

    }

};